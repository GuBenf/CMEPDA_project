<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CMEPDA Project: sim/Code/analysis.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CMEPDA Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4fedf3bc7458de691f44ea68a2cf9143.html">sim</a></li><li class="navelem"><a class="el" href="dir_f97803b1aaa0e1157009ed137dc24ce2.html">Code</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">analysis.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Code for analyzing data simulated with Geant4.  
<a href="#details">More...</a></p>

<p><a href="analysis_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1932de695f51d87dd727bed5c2907940" id="r_a1932de695f51d87dd727bed5c2907940"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1932de695f51d87dd727bed5c2907940">analysis</a> (TString file, TString name)</td></tr>
<tr class="memdesc:a1932de695f51d87dd727bed5c2907940"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analyze simulated muon lifetime data and generate a histogram with an exponential fit.  <br /></td></tr>
<tr class="separator:a1932de695f51d87dd727bed5c2907940"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Code for analyzing data simulated with Geant4. </p>
<p>This program reads data from a ROOT file generated by Geant4 simulations, specifically focusing on the detection of muons and their decay products. It plots the time intervals between detected muons and their decay positrons and fits an exponential decay curve to estimate the muon lifetime.</p>
<p>The function <code>analysis</code> takes as arguments the name of the data file and a specifier for the analysis folder path. If the name is "a" or "g", predefined paths for specific users are used. For any other input, the user must provide the full folder path manually.</p>
<dl class="section note"><dt>Note</dt><dd>The function relies on ROOT libraries for data handling, histogramming, and fitting.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Benfratello G. </dd>
<dd>
Niccolai A. </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2024-12-04 </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>

<p class="definition">Definition in file <a class="el" href="analysis_8cpp_source.html">analysis.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a1932de695f51d87dd727bed5c2907940" name="a1932de695f51d87dd727bed5c2907940"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1932de695f51d87dd727bed5c2907940">&#9670;&#160;</a></span>analysis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void analysis </td>
          <td>(</td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>file</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Analyze simulated muon lifetime data and generate a histogram with an exponential fit. </p>
<p>This function processes ROOT files containing simulated detector data to analyze the time intervals between detected muons and their decay positrons. The results are visualized as a histogram with an exponential decay fit, representing the muon lifetime.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The name of the ROOT file to analyze (e.g., "data.root"). </td></tr>
    <tr><td class="paramname">name</td><td>A specifier for the analysis folder path. Use:<ul>
<li>"a" for Alberto's folder path,</li>
<li>"g" for Guglielmo's folder path,</li>
<li>Any other value must specify the full custom folder path.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<p>The function:</p><ul>
<li>Determines the file path based on the <code>name</code> parameter.</li>
<li>Reads the <code>Hits</code> tree from the ROOT file.</li>
<li>Extracts event-based PMT hit and timing data.</li>
<li>Populates a histogram of time intervals (in microseconds).</li>
<li>Fits the histogram with an exponential function to calculate the muon lifetime.</li>
</ul>
<p>The histogram is displayed on a canvas with the fit overlay.</p>
<p>Example usage: </p><div class="fragment"><div class="line">root [0] .L <a class="code hl_function" href="#a1932de695f51d87dd727bed5c2907940">analysis</a>.cpp </div>
<div class="line">root [1] <a class="code hl_function" href="#a1932de695f51d87dd727bed5c2907940">analysis</a>(<span class="stringliteral">&quot;output.root&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="ttc" id="aanalysis_8cpp_html_a1932de695f51d87dd727bed5c2907940"><div class="ttname"><a href="#a1932de695f51d87dd727bed5c2907940">analysis</a></div><div class="ttdeci">void analysis(TString file, TString name)</div><div class="ttdoc">Analyze simulated muon lifetime data and generate a histogram with an exponential fit.</div><div class="ttdef"><b>Definition</b> <a href="analysis_8cpp_source.html#l00050">analysis.cpp:50</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="analysis_8cpp_source.html#l00050">50</a> of file <a class="el" href="analysis_8cpp_source.html">analysis.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   50</span>                                         {</div>
<div class="line"><span class="lineno">   51</span>  <span class="comment">// Define the default folder path based on the name argument</span></div>
<div class="line"><span class="lineno">   52</span>  TString filepath = <span class="stringliteral">&quot;../&quot;</span>;</div>
<div class="line"><span class="lineno">   53</span>  <span class="keywordflow">if</span> (name==<span class="stringliteral">&quot;a&quot;</span>){</div>
<div class="line"><span class="lineno">   54</span>    filepath = <span class="stringliteral">&quot;/Users/Alberto/Desktop/Magistrale/Computing_methods/Progetto/CMEPDA_Project/sim/&quot;</span>;</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>  }</div>
<div class="line"><span class="lineno">   57</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name == <span class="stringliteral">&quot;g&quot;</span>){</div>
<div class="line"><span class="lineno">   58</span>    filepath = <span class="stringliteral">&quot;/home/guglibenfri/CMEPDA_project/sim/Data/&quot;</span>;</div>
<div class="line"><span class="lineno">   59</span>  }</div>
<div class="line"><span class="lineno">   60</span>  <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">   61</span>    filepath = name;   <span class="comment">// Custom path provided by the user</span></div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>  }</div>
<div class="line"><span class="lineno">   64</span>  filepath.Append(file);</div>
<div class="line"><span class="lineno">   65</span>  </div>
<div class="line"><span class="lineno">   66</span>  <span class="comment">// Open the ROOT file</span></div>
<div class="line"><span class="lineno">   67</span>  TFile *filename = <span class="keyword">new</span> TFile(filepath, <span class="stringliteral">&quot;READ&quot;</span>);</div>
<div class="line"><span class="lineno">   68</span>  TTree *tree;</div>
<div class="line"><span class="lineno">   69</span>  filename-&gt;GetObject(<span class="stringliteral">&quot;Hits&quot;</span>, tree);</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>  <span class="comment">// Declare variables for tree branches</span></div>
<div class="line"><span class="lineno">   72</span>  <span class="keywordtype">int</span> event;</div>
<div class="line"><span class="lineno">   73</span>  <span class="keywordtype">int</span> d1, d2, d3, d4, d5, d6;</div>
<div class="line"><span class="lineno">   74</span>  <span class="keywordtype">double</span> t1, t2, t3, t4, t5, t6, time;</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>  <span class="comment">// Set branch addresses for event and PMT data</span></div>
<div class="line"><span class="lineno">   77</span>  tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;fEvent&quot;</span>, &amp;event);</div>
<div class="line"><span class="lineno">   78</span>  tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;PMT1&quot;</span>, &amp;d1);</div>
<div class="line"><span class="lineno">   79</span>  tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;PMT2&quot;</span>, &amp;d2);</div>
<div class="line"><span class="lineno">   80</span>  tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;PMT3&quot;</span>, &amp;d3);</div>
<div class="line"><span class="lineno">   81</span>  tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;PMT4&quot;</span>, &amp;d4);</div>
<div class="line"><span class="lineno">   82</span>  tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;PMT5&quot;</span>, &amp;d5);</div>
<div class="line"><span class="lineno">   83</span>  tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;PMT6&quot;</span>, &amp;d6);</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>  <span class="comment">// Set branch addresses for timing data</span></div>
<div class="line"><span class="lineno">   86</span>  tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;T_1&quot;</span>, &amp;t1);</div>
<div class="line"><span class="lineno">   87</span>  tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;T_2&quot;</span>, &amp;t2);</div>
<div class="line"><span class="lineno">   88</span>  tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;T_3&quot;</span>, &amp;t3);</div>
<div class="line"><span class="lineno">   89</span>  tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;T_4&quot;</span>, &amp;t4);</div>
<div class="line"><span class="lineno">   90</span>  tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;T_5&quot;</span>, &amp;t5);</div>
<div class="line"><span class="lineno">   91</span>  tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;T_6&quot;</span>, &amp;t6);</div>
<div class="line"><span class="lineno">   92</span>  tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;Times&quot;</span>, &amp;time);</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>  <span class="keywordtype">int</span> totalEntries = tree-&gt;GetEntries(); <span class="comment">// Total number of entries in the tree</span></div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>  <span class="comment">// Count total number of unique events</span></div>
<div class="line"><span class="lineno">   97</span>  <span class="keywordtype">int</span> totalEvents = 0;</div>
<div class="line"><span class="lineno">   98</span>  <span class="keywordtype">int</span> currentEvent, nextEvent;</div>
<div class="line"><span class="lineno">   99</span>  tree-&gt;GetEntry(0);</div>
<div class="line"><span class="lineno">  100</span>  currentEvent = event;</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; totalEntries; i++)</div>
<div class="line"><span class="lineno">  103</span>  {</div>
<div class="line"><span class="lineno">  104</span>    tree-&gt;GetEntry(i);</div>
<div class="line"><span class="lineno">  105</span>    nextEvent = event;</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>    <span class="comment">// Compare current event with next event</span></div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">if</span> (currentEvent == nextEvent) {</div>
<div class="line"><span class="lineno">  109</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  110</span>    } <span class="keywordflow">else</span> {totalEvents += 1;};</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    <span class="comment">// Move to next entry</span></div>
<div class="line"><span class="lineno">  113</span>    currentEvent = nextEvent;</div>
<div class="line"><span class="lineno">  114</span>  }</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>  <span class="comment">// Create a histogram for the time intervals</span></div>
<div class="line"><span class="lineno">  117</span>  TH1D *hist= <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;Mu-Life simulation&quot;</span>, <span class="stringliteral">&quot;Mu-Life simulation&quot;</span>, 100, 0., 0.);</div>
<div class="line"><span class="lineno">  118</span>  hist-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Time [#mu s]&quot;</span>);</div>
<div class="line"><span class="lineno">  119</span>  hist-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Entries&quot;</span>);</div>
<div class="line"><span class="lineno">  120</span>  hist-&gt;SetFillColor(kAzure-4);</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>  <span class="comment">// Cycle to take one time value per event, the first one coming from the e+/e- scintillation</span></div>
<div class="line"><span class="lineno">  123</span>  <span class="keywordtype">int</span> prevevt = -1;</div>
<div class="line"><span class="lineno">  124</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ev = 0; ev &lt; totalEntries; ev++) {</div>
<div class="line"><span class="lineno">  125</span>    tree-&gt;GetEntry(ev);</div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordflow">if</span>(time &gt; 0.050){  <span class="comment">// Filter out invalid or small time intervals</span></div>
<div class="line"><span class="lineno">  127</span>        <span class="keywordflow">if</span>(event &gt; prevevt &amp;&amp; (d2 == 1 || d3 == 1 || d4 == 1 )){  <span class="comment">// Take only those from target (2,3,4)</span></div>
<div class="line"><span class="lineno">  128</span>        hist-&gt;Fill(time);</div>
<div class="line"><span class="lineno">  129</span>          prevevt = event;</div>
<div class="line"><span class="lineno">  130</span>        }</div>
<div class="line"><span class="lineno">  131</span>    }</div>
<div class="line"><span class="lineno">  132</span>  }</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>  <span class="comment">// Create a canvas and fit the histogram with an exponential decay function</span></div>
<div class="line"><span class="lineno">  135</span>  TCanvas *c = <span class="keyword">new</span> TCanvas(<span class="stringliteral">&quot;Fit Muon lifetime&quot;</span>, <span class="stringliteral">&quot;Fit Muon lifetime&quot;</span>);</div>
<div class="line"><span class="lineno">  136</span>  TF1 *fitFunction = <span class="keyword">new</span> TF1(<span class="stringliteral">&quot;fitFunction&quot;</span>, <span class="stringliteral">&quot;[1]/[0] * TMath::Exp(-x / [0])&quot;</span>, 0. ,20000.);</div>
<div class="line"><span class="lineno">  137</span>  fitFunction-&gt;SetParameters(2150., 100);</div>
<div class="line"><span class="lineno">  138</span>  fitFunction-&gt;SetParNames(<span class="stringliteral">&quot;#tau&quot;</span>, <span class="stringliteral">&quot;Ampiezza&quot;</span>);</div>
<div class="line"><span class="lineno">  139</span>  hist-&gt;Fit(<span class="stringliteral">&quot;fitFunction&quot;</span>, <span class="stringliteral">&quot;LI&quot;</span>);</div>
<div class="line"><span class="lineno">  140</span>  hist-&gt;Draw();</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
